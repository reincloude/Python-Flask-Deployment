swagger: "2.0"
info:
  title: "Python Flask API"
  description: "Prediction Expense API"
  version: "1.0.0"

host: "{GATEWAY_HOST}"  # Required by API Gateway

schemes:
  - https
produces:
  - application/json

paths:
  /:
    get:
      summary: Home page
      operationId: home
      responses:
        "200":
          description: A successful response
      x-google-backend:
        address: https://${cloud_run_url}
        protocol: h2

  /predict:
    post:
      summary: Make a prediction
      operationId: predict
      responses:
        "200":
          description: Prediction result
      x-google-backend:
        address: https://${cloud_run_url}
        protocol: h2

# Enable CORS
x-google-endpoints:
  - name: "{GATEWAY_HOST}"
    allowCors: true

# API key support
securityDefinitions:
  api_key:
    type: apiKey
    name: x-api-key
    in: header

security:
  - api_key: []  # Require API key globally
